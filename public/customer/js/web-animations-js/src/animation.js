!function(i,t,e){i.sequenceNumber=0;var n=function(i,t,e){this.target=i,this.currentTime=t,this.timelineTime=e,this.type="finish",this.bubbles=!1,this.cancelable=!1,this.currentTarget=i,this.defaultPrevented=!1,this.eventPhase=Event.AT_TARGET,this.timeStamp=Date.now()};t.Animation=function(t){this.id="",t&&t._id&&(this.id=t._id),this._sequenceNumber=i.sequenceNumber++,this._currentTime=0,this._startTime=null,this._paused=!1,this._playbackRate=1,this._inTimeline=!0,this._finishedFlag=!0,this.onfinish=null,this._finishHandlers=[],this._effect=t,this._inEffect=this._effect._update(0),this._idle=!0,this._currentTimePending=!1},t.Animation.prototype={_ensureAlive:function(){this.playbackRate<0&&0===this.currentTime?this._inEffect=this._effect._update(-1):this._inEffect=this._effect._update(this.currentTime),this._inTimeline||!this._inEffect&&this._finishedFlag||(this._inTimeline=!0,t.timeline._animations.push(this))},_tickCurrentTime:function(i,t){i!=this._currentTime&&(this._currentTime=i,this._isFinished&&!t&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this._ensureAlive())},get currentTime(){return this._idle||this._currentTimePending?null:this._currentTime},set currentTime(i){i=+i,isNaN(i)||(t.restart(),this._paused||null==this._startTime||(this._startTime=this._timeline.currentTime-i/this._playbackRate),this._currentTimePending=!1,this._currentTime!=i&&(this._idle&&(this._idle=!1,this._paused=!0),this._tickCurrentTime(i,!0),t.applyDirtiedAnimation(this)))},get startTime(){return this._startTime},set startTime(i){i=+i,isNaN(i)||this._paused||this._idle||(this._startTime=i,this._tickCurrentTime((this._timeline.currentTime-this._startTime)*this.playbackRate),t.applyDirtiedAnimation(this))},get playbackRate(){return this._playbackRate},set playbackRate(i){if(i!=this._playbackRate){var e=this.currentTime;this._playbackRate=i,this._startTime=null,"paused"!=this.playState&&"idle"!=this.playState&&(this._finishedFlag=!1,this._idle=!1,this._ensureAlive(),t.applyDirtiedAnimation(this)),null!=e&&(this.currentTime=e)}},get _isFinished(){return!this._idle&&(this._playbackRate>0&&this._currentTime>=this._totalDuration||this._playbackRate<0&&this._currentTime<=0)},get _totalDuration(){return this._effect._totalDuration},get playState(){return this._idle?"idle":null==this._startTime&&!this._paused&&0!=this.playbackRate||this._currentTimePending?"pending":this._paused?"paused":this._isFinished?"finished":"running"},_rewind:function(){if(this._playbackRate>=0)this._currentTime=0;else{if(!(this._totalDuration<1/0))throw new DOMException("Unable to rewind negative playback rate animation with infinite duration","InvalidStateError");this._currentTime=this._totalDuration}},play:function(){this._paused=!1,(this._isFinished||this._idle)&&(this._rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this._ensureAlive(),t.applyDirtiedAnimation(this)},pause:function(){this._isFinished||this._paused||this._idle?this._idle&&(this._rewind(),this._idle=!1):this._currentTimePending=!0,this._startTime=null,this._paused=!0},finish:function(){this._idle||(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this._currentTimePending=!1,t.applyDirtiedAnimation(this))},cancel:function(){this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._isFinished=!0,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this._effect._update(null),t.applyDirtiedAnimation(this))},reverse:function(){this.playbackRate*=-1,this.play()},addEventListener:function(i,t){"function"==typeof t&&"finish"==i&&this._finishHandlers.push(t)},removeEventListener:function(i,t){if("finish"==i){var e=this._finishHandlers.indexOf(t);e>=0&&this._finishHandlers.splice(e,1)}},_fireEvents:function(i){if(this._isFinished){if(!this._finishedFlag){var t=new n(this,this._currentTime,i),e=this._finishHandlers.concat(this.onfinish?[this.onfinish]:[]);setTimeout(function(){e.forEach(function(i){i.call(t.target,t)})},0),this._finishedFlag=!0}}else this._finishedFlag=!1},_tick:function(i,t){this._idle||this._paused||(null==this._startTime?t&&(this.startTime=i-this._currentTime/this.playbackRate):this._isFinished||this._tickCurrentTime((i-this._startTime)*this.playbackRate)),t&&(this._currentTimePending=!1,this._fireEvents(i))},get _needsTick(){return this.playState in{pending:1,running:1}||!this._finishedFlag},_targetAnimations:function(){var i=this._effect._target;return i._activeAnimations||(i._activeAnimations=[]),i._activeAnimations},_markTarget:function(){var i=this._targetAnimations();-1===i.indexOf(this)&&i.push(this)},_unmarkTarget:function(){var i=this._targetAnimations(),t=i.indexOf(this);-1!==t&&i.splice(t,1)}},WEB_ANIMATIONS_TESTING&&(e.webAnimations1Animation=t.Animation)}(webAnimationsShared,webAnimations1,webAnimationsTesting);