!function(i,t,e){t.animationsWithPromises=[],t.Animation=function(t,e){if(this.id="",t&&t._id&&(this.id=t._id),this.effect=t,t&&(t._animation=this),!e)throw new Error("Animation with null timeline is not supported");this._timeline=e,this._sequenceNumber=i.sequenceNumber++,this._holdTime=0,this._paused=!1,this._isGroup=!1,this._animation=null,this._childAnimations=[],this._callback=null,this._oldPlayState="idle",this._rebuildUnderlyingAnimation(),this._animation.cancel(),this._updatePromises()},t.Animation.prototype={_updatePromises:function(){var i=this._oldPlayState,t=this.playState;return this._readyPromise&&t!==i&&("idle"==t?(this._rejectReadyPromise(),this._readyPromise=void 0):"pending"==i?this._resolveReadyPromise():"pending"==t&&(this._readyPromise=void 0)),this._finishedPromise&&t!==i&&("idle"==t?(this._rejectFinishedPromise(),this._finishedPromise=void 0):"finished"==t?this._resolveFinishedPromise():"finished"==i&&(this._finishedPromise=void 0)),this._oldPlayState=this.playState,this._readyPromise||this._finishedPromise},_rebuildUnderlyingAnimation:function(){this._updatePromises();var i,e,n,s,a=!!this._animation;a&&(i=this.playbackRate,e=this._paused,n=this.startTime,s=this.currentTime,this._animation.cancel(),this._animation._wrapper=null,this._animation=null),(!this.effect||this.effect instanceof window.KeyframeEffect)&&(this._animation=t.newUnderlyingAnimationForKeyframeEffect(this.effect),t.bindAnimationForKeyframeEffect(this)),(this.effect instanceof window.SequenceEffect||this.effect instanceof window.GroupEffect)&&(this._animation=t.newUnderlyingAnimationForGroup(this.effect),t.bindAnimationForGroup(this)),this.effect&&this.effect._onsample&&t.bindAnimationForCustomEffect(this),a&&(1!=i&&(this.playbackRate=i),null!==n?this.startTime=n:null!==s?this.currentTime=s:null!==this._holdTime&&(this.currentTime=this._holdTime),e&&this.pause()),this._updatePromises()},_updateChildren:function(){if(this.effect&&"idle"!=this.playState){var i=this.effect._timing.delay;this._childAnimations.forEach(function(e){this._arrangeChildren(e,i),this.effect instanceof window.SequenceEffect&&(i+=t.groupChildDuration(e.effect))}.bind(this))}},_setExternalAnimation:function(i){if(this.effect&&this._isGroup)for(var t=0;t<this.effect.children.length;t++)this.effect.children[t]._animation=i,this._childAnimations[t]._setExternalAnimation(i)},_constructChildAnimations:function(){if(this.effect&&this._isGroup){var i=this.effect._timing.delay;this._removeChildAnimations(),this.effect.children.forEach(function(e){var n=t.timeline._play(e);this._childAnimations.push(n),n.playbackRate=this.playbackRate,this._paused&&n.pause(),e._animation=this.effect._animation,this._arrangeChildren(n,i),this.effect instanceof window.SequenceEffect&&(i+=t.groupChildDuration(e))}.bind(this))}},_arrangeChildren:function(i,t){null===this.startTime?i.currentTime=this.currentTime-t/this.playbackRate:i.startTime!==this.startTime+t/this.playbackRate&&(i.startTime=this.startTime+t/this.playbackRate)},get timeline(){return this._timeline},get playState(){return this._animation?this._animation.playState:"idle"},get finished(){return window.Promise?(this._finishedPromise||(-1==t.animationsWithPromises.indexOf(this)&&t.animationsWithPromises.push(this),this._finishedPromise=new Promise(function(i,t){this._resolveFinishedPromise=function(){i(this)},this._rejectFinishedPromise=function(){t({type:DOMException.ABORT_ERR,name:"AbortError"})}}.bind(this)),"finished"==this.playState&&this._resolveFinishedPromise()),this._finishedPromise):(console.warn("Animation Promises require JavaScript Promise constructor"),null)},get ready(){return window.Promise?(this._readyPromise||(-1==t.animationsWithPromises.indexOf(this)&&t.animationsWithPromises.push(this),this._readyPromise=new Promise(function(i,t){this._resolveReadyPromise=function(){i(this)},this._rejectReadyPromise=function(){t({type:DOMException.ABORT_ERR,name:"AbortError"})}}.bind(this)),"pending"!==this.playState&&this._resolveReadyPromise()),this._readyPromise):(console.warn("Animation Promises require JavaScript Promise constructor"),null)},get onfinish(){return this._animation.onfinish},set onfinish(i){this._animation.onfinish="function"==typeof i?function(t){t.target=this,i.call(this,t)}.bind(this):i},get oncancel(){return this._animation.oncancel},set oncancel(i){this._animation.oncancel="function"==typeof i?function(t){t.target=this,i.call(this,t)}.bind(this):i},get currentTime(){this._updatePromises();var i=this._animation.currentTime;return this._updatePromises(),i},set currentTime(i){this._updatePromises(),this._animation.currentTime=isFinite(i)?i:Math.sign(i)*Number.MAX_VALUE,this._register(),this._forEachChild(function(t,e){t.currentTime=i-e}),this._updatePromises()},get startTime(){return this._animation.startTime},set startTime(i){this._updatePromises(),this._animation.startTime=isFinite(i)?i:Math.sign(i)*Number.MAX_VALUE,this._register(),this._forEachChild(function(t,e){t.startTime=i+e}),this._updatePromises()},get playbackRate(){return this._animation.playbackRate},set playbackRate(i){this._updatePromises();var t=this.currentTime;this._animation.playbackRate=i,this._forEachChild(function(t){t.playbackRate=i}),null!==t&&(this.currentTime=t),this._updatePromises()},play:function(){this._updatePromises(),this._paused=!1,this._animation.play(),-1==this._timeline._animations.indexOf(this)&&this._timeline._animations.push(this),this._register(),t.awaitStartTime(this),this._forEachChild(function(i){var t=i.currentTime;i.play(),i.currentTime=t}),this._updatePromises()},pause:function(){this._updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),this._animation.pause(),this._register(),this._forEachChild(function(i){i.pause()}),this._paused=!0,this._updatePromises()},finish:function(){this._updatePromises(),this._animation.finish(),this._register(),this._updatePromises()},cancel:function(){this._updatePromises(),this._animation.cancel(),this._register(),this._removeChildAnimations(),this._updatePromises()},reverse:function(){this._updatePromises();var i=this.currentTime;this._animation.reverse(),this._forEachChild(function(i){i.reverse()}),null!==i&&(this.currentTime=i),this._updatePromises()},addEventListener:function(i,t){var e=t;"function"==typeof t&&(e=function(i){i.target=this,t.call(this,i)}.bind(this),t._wrapper=e),this._animation.addEventListener(i,e)},removeEventListener:function(i,t){this._animation.removeEventListener(i,t&&t._wrapper||t)},_removeChildAnimations:function(){for(;this._childAnimations.length;)this._childAnimations.pop().cancel()},_forEachChild:function(t){var e=0;if(this.effect.children&&this._childAnimations.length<this.effect.children.length&&this._constructChildAnimations(),this._childAnimations.forEach(function(i){t.call(this,i,e),this.effect instanceof window.SequenceEffect&&(e+=i.effect.activeDuration)}.bind(this)),"pending"!=this.playState){var n=this.effect._timing,s=this.currentTime;null!==s&&(s=i.calculateIterationProgress(i.calculateActiveDuration(n),s,n)),(null==s||isNaN(s))&&this._removeChildAnimations()}}},window.Animation=t.Animation,WEB_ANIMATIONS_TESTING&&(e.webAnimationsNextAnimation=t.Animation)}(webAnimationsShared,webAnimationsNext,webAnimationsTesting);